<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>TimeZone</title>
  <meta name="description" content="Personal site">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://imdrasil.github.io/time_zone/">
  <link rel="alternate" type="application/rss+xml" title="Imdrasil Homebrew Stuff" href="/feed.xml">
  
  
</head>


  <body>

    <header class="site-header" role="banner">
  <div class="wrapper">
    
    
    <a class="site-title" href="/">Imdrasil Homebrew Stuff</a>
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">TimeZone</h1>
  </header>

  <div class="post-content">
    <h1 id="timezone---">TimeZone <a href="https://travis-ci.org/imdrasil/time_zone"><img src="https://travis-ci.org/imdrasil/time_zone.svg" alt="Build Status" /></a> <a href="https://github.com/imdrasil/time_zone/releases"><img src="https://img.shields.io/github/release/imdrasil/time_zone.svg" alt="Latest Release" /></a> <a href="https://imdrasil.github.io/time_zone/latest/"><img src="https://img.shields.io/badge/docs-available-brightgreen.svg" alt="Docs" /></a></h1>

<p><strong>Time Zone</strong> provides daylight savings aware transformations between times in different time zones. Also this is a port of ruby <a href="https://github.com/tzinfo/tzinfo">tzinfo</a> gem.</p>

<h2 id="installation">Installation</h2>

<p>Add this to your application’s <code class="highlighter-rouge">shard.yml</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">dependencies</span><span class="pi">:</span>
  <span class="na">time_zone</span><span class="pi">:</span>
    <span class="na">github</span><span class="pi">:</span> <span class="s">imdrasil/time_zone</span>
</code></pre></div></div>

<h2 id="usage">Usage</h2>

<p>The following code will obtain the America/New_York timezone (as an instance
of <code class="highlighter-rouge">TZInfo::Timezone</code>) and convert a time in UTC to local New York time:</p>

<div class="language-crystal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">require</span> <span class="s2">"time_zone"</span>

<span class="n">tz</span> <span class="o">=</span> <span class="no">TimeZone</span><span class="o">::</span><span class="no">Zone</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"America/New_York"</span><span class="p">)</span>
<span class="n">local</span> <span class="o">=</span> <span class="n">tz</span><span class="p">.</span><span class="nf">utc_to_local</span><span class="p">(</span><span class="no">Time</span><span class="p">.</span><span class="nf">utc</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div></div>

<p>Note that the local Time returned will be kind of UTC (<code class="highlighter-rouge">local.kind</code> will
return <code class="highlighter-rouge">Time::Kind::Utc</code>). This is because the Crystal <code class="highlighter-rouge">Time</code> class only supports two timezones:</p>
<ul>
  <li>UTC</li>
  <li>the current system local timezone.</li>
</ul>

<p>To convert from a local time to UTC, the <code class="highlighter-rouge">#local_to_utc</code> method can be used as
follows:</p>

<div class="language-crystal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">utc</span> <span class="o">=</span> <span class="n">tz</span><span class="p">.</span><span class="nf">local_to_utc</span><span class="p">(</span><span class="n">local</span><span class="p">)</span>
</code></pre></div></div>

<p>Note that the time zone information of the local Time object is ignored (TimeZone
will just read the date and time and treat them as if there were in the <code class="highlighter-rouge">tz</code>
timezone). The following two lines will return the same result regardless of
the system’s local timezone:</p>

<div class="language-crystal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tz</span><span class="p">.</span><span class="nf">local_to_utc</span><span class="p">(</span><span class="no">Time</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">2006</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">tz</span><span class="p">.</span><span class="nf">local_to_utc</span><span class="p">(</span><span class="no">Time</span><span class="p">.</span><span class="nf">utc</span><span class="p">(</span><span class="mi">2006</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div></div>

<p>The current local time in a <code class="highlighter-rouge">Zone</code> can be obtained with the
<code class="highlighter-rouge">TimeZone::Zone#now</code> method:</p>

<div class="language-crystal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">now</span> <span class="o">=</span> <span class="n">tz</span><span class="p">.</span><span class="nf">now</span>
</code></pre></div></div>

<p>A list of all the available timezone identifiers can be obtained using the
<code class="highlighter-rouge">TimeZone::Zone.all_identifiers</code> method. <code class="highlighter-rouge">TimeZone::Zone.all</code> can be called
to get an <code class="highlighter-rouge">Array</code> of all the <code class="highlighter-rouge">TimeZone::Zone</code> and <code class="highlighter-rouge">TimeZone::LinkedZone</code> instances.</p>

<p>Timezones can also be accessed by country (using an ISO 3166-1 alpha-2 country
code). The following code retrieves the <code class="highlighter-rouge">TimeZone::Country</code> instance representing
the USA (country code ‘US’) and then gets all the timezone identifiers used in
the USA.</p>

<div class="language-crystal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">us</span> <span class="o">=</span> <span class="no">TimeZone</span><span class="o">::</span><span class="no">Country</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s1">'US'</span><span class="p">)</span>
<span class="n">timezones</span> <span class="o">=</span> <span class="n">us</span><span class="p">.</span><span class="nf">zone_identifiers</span>
</code></pre></div></div>

<p>A list of all the available country codes can be obtained using the
<code class="highlighter-rouge">TimeZone::Country.all_codes</code> method. <code class="highlighter-rouge">TimeZone::Country.all</code> can be called to get
an <code class="highlighter-rouge">Array</code> of all the <code class="highlighter-rouge">Country</code> instances.</p>

<h3 id="timezonetime">TimeZone::Time</h3>

<p>To hold time zone in the time object <code class="highlighter-rouge">TimeZone::Time</code> struct could be used. It provides almost same interface as the <code class="highlighter-rouge">Time</code> does. Also there is 2 methods added to <code class="highlighter-rouge">Time</code>:</p>
<ul>
  <li><code class="highlighter-rouge">#to_time_zone_time</code> - converts current time object to <code class="highlighter-rouge">TimeZone::Time</code> in default time zone;</li>
  <li><code class="highlighter-rouge">::zone</code> - returns default time zone.</li>
</ul>

<p>To set or get default time zone next code can be used:</p>

<div class="language-crystal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">TimeZone</span><span class="o">::</span><span class="no">Zone</span><span class="p">.</span><span class="nf">default</span> <span class="c1"># tries to read time zone from `TZ`</span>
					   <span class="c1"># environment variable, otherwise UTC </span>
					   <span class="c1"># will be used</span>
<span class="no">TimeZone</span><span class="o">::</span><span class="no">Zone</span><span class="p">.</span><span class="nf">default</span> <span class="o">=</span> <span class="s2">"America/New_York"</span>
<span class="c1"># or</span>
<span class="no">TimeZone</span><span class="o">::</span><span class="no">Zone</span><span class="p">.</span><span class="nf">default</span> <span class="o">=</span> <span class="no">TimeZone</span><span class="o">::</span><span class="no">Zone</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="s2">"America/New_York"</span><span class="p">)</span>
</code></pre></div></div>

<p>To create specific date in time zone:</p>

<div class="language-crystal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">zone</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="no">Time</span><span class="p">.</span><span class="nf">zone</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="c1"># in the default time zone</span>
</code></pre></div></div>

<p>Also <code class="highlighter-rouge">TimeZone::Time</code> could be parsed from string with grepping given time zone offset:</p>

<div class="language-crystal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Time zone will be set to Etc/GMT-5</span>
<span class="no">TimeZone</span><span class="o">::</span><span class="no">Time</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s2">"2014-10-31 10:11:12 +05:00"</span><span class="p">,</span> <span class="s2">"%F %T %z"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="development">Development</h2>

<h3 id="data-generating">Data Generating</h3>

<p>All code in <code class="highlighter-rouge">src/time_zone/data</code> folder is automatically generated so please don’t try to make any change there because they will be lost after next regenerating. To generate new version please paste all files from original <a href="https://github.com/eggert/tz">repo</a> to the <code class="highlighter-rouge">data</code> folder in the this repo root and invoke <code class="highlighter-rouge">ruby scripts/build.rb</code>.</p>

<h2 id="contributing">Contributing</h2>

<ol>
  <li>Fork it ( https://github.com/imdrasil/time_zone/fork )</li>
  <li>Create your feature branch (git checkout -b my-new-feature)</li>
  <li>Commit your changes (git commit -am ‘Add some feature’)</li>
  <li>Push to the branch (git push origin my-new-feature)</li>
  <li>Create a new Pull Request</li>
</ol>

<h2 id="contributors">Contributors</h2>

<ul>
  <li><a href="https://github.com/[your-github-name]">imdrasil</a> Roman Kalnytskyi - creator, maintainer</li>
</ul>

  </div>

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Imdrasil Homebrew Stuff</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              Imdrasil Homebrew Stuff
            
            </li>
            
            <li><a href="mailto:moranibaca@gmail.com">moranibaca@gmail.com</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/imdrasil"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">imdrasil</span></a>

          </li>
          

          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Personal site</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
